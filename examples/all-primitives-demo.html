<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Three-Edit Primitives Demo</title>
    <link rel="stylesheet" href="demo-styles.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>üéØ All Three-Edit Primitives Demo</h1>
        <p class="subtitle">
            All refactored primitives displayed together in different positions
        </p>
        
        <div class="controls">
            <button onclick="showAllPrimitives()">üé® Show All Primitives</button>
            <button onclick="clearScene()">üóëÔ∏è Clear Scene</button>
            <button onclick="toggleRotation()">üîÑ Toggle Rotation</button>
        </div>
        
        <div class="canvas-container" id="canvas">
            <div class="status">Ready - Click "Show All Primitives" to see them all</div>
        </div>
        
        <div class="stats" id="stats">
            <div class="stat-card">
                <div class="stat-value" id="total-primitives">0</div>
                <div class="stat-label">Total Primitives</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="total-vertices">0</div>
                <div class="stat-label">Total Vertices</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="total-faces">0</div>
                <div class="stat-label">Total Faces</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="creation-time">0ms</div>
                <div class="stat-label">Creation Time</div>
            </div>
        </div>
        
        <div class="info" id="info">
            <strong>All Primitives Demo</strong><br><br>
            This demo creates all our refactored primitives and positions them in different locations 
            so you can see them all working together. Each primitive has its own color and position.<br><br>
            
            <strong>Primitives included:</strong><br>
            üß± Cube, üîµ Sphere, üîò Cylinder, üìÑ Plane<br><br>
            
            Click "Show All Primitives" to see them all in action!
        </div>
        
        <div class="code-example">
// Example of creating all primitives with different positions:

const primitives = [
    { type: 'cube', position: [-6, 0, 0], color: 0x4CAF50 },
    { type: 'sphere', position: [-4, 0, 0], color: 0x2196F3 },
    { type: 'cylinder', position: [-2, 0, 0], color: 0xFF9800 },
    { type: 'cone', position: [0, 0, 0], color: 0x9C27B0 },
    { type: 'plane', position: [2, 0, 0], color: 0x607D8B },
    { type: 'torus', position: [4, 0, 0], color: 0xE91E63 },
    { type: 'circle', position: [6, 0, 0], color: 0x00BCD4 },
    { type: 'pyramid', position: [-6, 3, 0], color: 0x795548 },
    { type: 'tetrahedron', position: [-4, 3, 0], color: 0x3F51B5 },
    { type: 'octahedron', position: [-2, 3, 0], color: 0x009688 },
    { type: 'icosahedron', position: [0, 3, 0], color: 0xFF5722 }
];

// All primitives use the same standardized API!
        </div>
    </div>

    <!-- Load Three.js from CDN -->
    <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
    
    <!-- Load three-edit browser version after Three.js is loaded -->
    <script>
        // Ensure Three.js is loaded before loading ThreeEdit
        if (typeof THREE === 'undefined') {
            console.error('Three.js failed to load, trying alternative CDN...');
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js';
            script.onload = function() {
                console.log('Three.js loaded from alternative CDN');
                loadThreeEdit();
            };
            document.head.appendChild(script);
        } else {
            console.log('Three.js loaded successfully');
            loadThreeEdit();
        }
        
        function loadThreeEdit() {
            const script = document.createElement('script');
            script.src = '../browser/three-edit.js?v=1';
            script.onload = function() {
                console.log('ThreeEdit loaded successfully');
            };
            document.head.appendChild(script);
        }
    </script>
    
    <script>
        // Global variables
        let scene, camera, renderer;
        let meshes = [];
        let isRotating = true;
        let creationStartTime = 0;
        
        // Initialize Three.js scene
        function initScene() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, 800 / 500, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(800, 500);
            renderer.setClearColor(0x000000);
            
            const container = document.getElementById('canvas');
            container.innerHTML = '';
            container.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 10, 5);
            scene.add(directionalLight);
            
            camera.position.set(0, 5, 15);
            camera.lookAt(0, 0, 0);
            
            // Start animation loop
            animate();
        }
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            if (isRotating) {
                meshes.forEach((mesh, index) => {
                    mesh.rotation.x += 0.01;
                    mesh.rotation.y += 0.01;
                });
            }
            
            renderer.render(scene, camera);
        }
        
        // Update statistics display
        function updateStats(totalPrimitives, totalVertices, totalFaces, creationTime) {
            document.getElementById('total-primitives').textContent = totalPrimitives;
            document.getElementById('total-vertices').textContent = totalVertices;
            document.getElementById('total-faces').textContent = totalFaces;
            document.getElementById('creation-time').textContent = creationTime + 'ms';
        }
        
        // Update info display
        function updateInfo(message, details = '') {
            const info = document.getElementById('info');
            info.innerHTML = `<strong>${message}</strong><br><br>${details}`;
        }
        
        // Update status
        function updateStatus(message) {
            const status = document.querySelector('.status');
            if (status) {
                status.textContent = message;
            } else {
                console.log(`Status: ${message}`);
            }
        }
        
        // Create primitive function
        function createPrimitive(type, position, color) {
            try {
                // Debug: Check if ThreeEdit functions are available
                if (typeof ThreeEdit === 'undefined') {
                    throw new Error('ThreeEdit is not loaded');
                }
                
                console.log(`Creating ${type} with ThreeEdit.${type} function:`, typeof ThreeEdit[`create${type.charAt(0).toUpperCase() + type.slice(1)}`]);
                
                let mesh;
                
                switch(type) {
                    case 'cube':
                        mesh = ThreeEdit.createCube({
                            width: 1.5, height: 1.5, depth: 1.5,
                            materialId: 0, centered: true, validate: true
                        });
                        break;
                    case 'sphere':
                        mesh = ThreeEdit.createSphere({
                            radius: 0.8, widthSegments: 16, heightSegments: 8,
                            materialId: 0, centered: true, validate: true
                        });
                        break;
                    case 'cylinder':
                        mesh = ThreeEdit.createCylinder({
                            radiusTop: 0.6, radiusBottom: 0.6, height: 1.5,
                            radialSegments: 12, heightSegments: 1,
                            materialId: 0, centered: true, validate: true
                        });
                        break;
                    case 'plane':
                        mesh = ThreeEdit.createPlane({
                            width: 1.5, height: 1.5, widthSegments: 1, heightSegments: 1,
                            materialId: 0, centered: true, validate: true
                        });
                        break;
                    default:
                        throw new Error(`Unknown primitive type: ${type}`);
                }
                
                // Convert to Three.js BufferGeometry
                const geometry = ThreeEdit.toBufferGeometry(mesh);
                const material = new THREE.MeshPhongMaterial({ 
                    color: color,
                    wireframe: false,
                    side: THREE.DoubleSide
                });
                
                const threeMesh = new THREE.Mesh(geometry, material);
                threeMesh.position.set(position[0], position[1], position[2]);
                
                return { mesh: threeMesh, editableMesh: mesh };
                
            } catch (error) {
                console.error(`Error creating ${type}:`, error);
                return null;
            }
        }
        
        // Show all primitives
        function showAllPrimitives() {
            creationStartTime = Date.now();
            
            // Clear existing meshes
            clearScene();
            
            // Define all primitives with positions and colors (only available in browser version)
            const primitives = [
                { type: 'cube', position: [-4, 0, 0], color: 0x4CAF50, name: 'Cube' },
                { type: 'sphere', position: [-2, 0, 0], color: 0x2196F3, name: 'Sphere' },
                { type: 'cylinder', position: [0, 0, 0], color: 0xFF9800, name: 'Cylinder' },
                { type: 'plane', position: [2, 0, 0], color: 0x607D8B, name: 'Plane' },
                { type: 'cube', position: [4, 0, 0], color: 0xE91E63, name: 'Cube 2' },
                { type: 'sphere', position: [-4, 3, 0], color: 0x00BCD4, name: 'Sphere 2' },
                { type: 'cylinder', position: [-2, 3, 0], color: 0x795548, name: 'Cylinder 2' },
                { type: 'plane', position: [0, 3, 0], color: 0x3F51B5, name: 'Plane 2' }
            ];
            
            let totalVertices = 0;
            let totalFaces = 0;
            let successfulPrimitives = 0;
            
            // Create each primitive
            primitives.forEach(primitive => {
                const result = createPrimitive(primitive.type, primitive.position, primitive.color);
                if (result) {
                    scene.add(result.mesh);
                    meshes.push(result.mesh);
                    
                    totalVertices += result.editableMesh.vertices.length;
                    totalFaces += result.editableMesh.faces.length;
                    successfulPrimitives++;
                    
                    console.log(`‚úÖ Created ${primitive.name}: ${result.editableMesh.vertices.length} vertices, ${result.editableMesh.faces.length} faces`);
                } else {
                    console.log(`‚ùå Failed to create ${primitive.name}`);
                }
            });
            
            const creationTime = Date.now() - creationStartTime;
            
            // Update statistics
            updateStats(successfulPrimitives, totalVertices, totalFaces, creationTime);
            
            // Update info
            updateInfo('All Primitives Created Successfully!', 
                `Created ${successfulPrimitives} out of ${primitives.length} primitives.<br><br>
                <strong>Statistics:</strong><br>
                üìä Total vertices: ${totalVertices}<br>
                üìä Total faces: ${totalFaces}<br>
                ‚ö° Creation time: ${creationTime}ms<br><br>
                <strong>Features:</strong><br>
                ‚úÖ All primitives use standardized helpers<br>
                ‚úÖ Automatic validation<br>
                ‚úÖ Proper UV mapping<br>
                ‚úÖ Three.js conversion<br>
                ‚úÖ Different colors and positions<br>
                ‚úÖ Real-time rotation`);
            
            updateStatus(`${successfulPrimitives} primitives created and displayed`);
        }
        
        // Clear scene
        function clearScene() {
            meshes.forEach(mesh => {
                scene.remove(mesh);
            });
            meshes = [];
            
            updateStats(0, 0, 0, 0);
            updateInfo('Scene Cleared', 'All primitives have been removed from the scene.');
            updateStatus('Scene cleared');
        }
        
        // Toggle rotation
        function toggleRotation() {
            isRotating = !isRotating;
            updateStatus(isRotating ? 'Rotation enabled' : 'Rotation disabled');
        }
        
        // Initialize the demo
        function initializeDemo() {
            // Debug: Check if Three.js is loaded
            console.log('THREE available:', typeof THREE !== 'undefined');
            if (typeof THREE !== 'undefined') {
                console.log('THREE version:', THREE.REVISION);
            }
            
            // Debug: Check if ThreeEdit is loaded
            console.log('ThreeEdit available:', typeof ThreeEdit !== 'undefined');
            if (typeof ThreeEdit !== 'undefined') {
                console.log('ThreeEdit functions:', Object.keys(ThreeEdit));
            }
            
            if (typeof THREE !== 'undefined' && typeof ThreeEdit !== 'undefined') {
                initScene();
                updateStatus('Demo ready - click "Show All Primitives" to see them all');
            } else {
                console.log('Waiting for libraries to load...');
                setTimeout(initializeDemo, 100);
            }
        }
        
        window.addEventListener('load', initializeDemo);
    </script>
</body>
</html> 